INFO - classes.py - 50 - Opening file /Users/aryanvafadar/Documents/GitHub/machine_learning_models/files/input_files/house_prices_data.csv to create into a pandas dataframe.
INFO - classes.py - 56 - Initial DataFrame successfully created and set to self.initial_frame
INFO - classes.py - 57 - Shape of Initial Frame: (21613, 21)
INFO - classes.py - 58 - Initial Frame Columns: Index(['id', 'date', 'price', 'bedrooms', 'bathrooms', 'sqft_living',
       'sqft_lot', 'floors', 'waterfront', 'view', 'condition', 'grade',
       'sqft_above', 'sqft_basement', 'yr_built', 'yr_renovated', 'zipcode',
       'lat', 'long', 'sqft_living15', 'sqft_lot15'],
      dtype='object')
INFO - classes.py - 59 - Initial Frame DataTypes: {'id': dtype('int64'), 'date': dtype('O'), 'price': dtype('float64'), 'bedrooms': dtype('int64'), 'bathrooms': dtype('float64'), 'sqft_living': dtype('int64'), 'sqft_lot': dtype('int64'), 'floors': dtype('float64'), 'waterfront': dtype('int64'), 'view': dtype('int64'), 'condition': dtype('int64'), 'grade': dtype('int64'), 'sqft_above': dtype('int64'), 'sqft_basement': dtype('int64'), 'yr_built': dtype('int64'), 'yr_renovated': dtype('int64'), 'zipcode': dtype('int64'), 'lat': dtype('float64'), 'long': dtype('float64'), 'sqft_living15': dtype('int64'), 'sqft_lot15': dtype('int64')}
INFO - classes.py - 60 - Intial Frame Contains Null Values?: id               False
date             False
price            False
bedrooms         False
bathrooms        False
sqft_living      False
sqft_lot         False
floors           False
waterfront       False
view             False
condition        False
grade            False
sqft_above       False
sqft_basement    False
yr_built         False
yr_renovated     False
zipcode          False
lat              False
long             False
sqft_living15    False
sqft_lot15       False
dtype: bool
INFO - classes.py - 61 - Total Number of Null Values in Each Column: id               0
date             0
price            0
bedrooms         0
bathrooms        0
sqft_living      0
sqft_lot         0
floors           0
waterfront       0
view             0
condition        0
grade            0
sqft_above       0
sqft_basement    0
yr_built         0
yr_renovated     0
zipcode          0
lat              0
long             0
sqft_living15    0
sqft_lot15       0
dtype: int64
INFO - classes.py - 85 - remove_columns function called. List of columns to remove: ['id', 'date', 'waterfront', 'sqft_above', 'sqft_basement', 'yr_built', 'yr_renovated', 'zipcode', 'lat', 'long', 'sqft_living15', 'sqft_lot15']
INFO - classes.py - 89 - Current columns in the dataframe: ['id', 'date', 'price', 'bedrooms', 'bathrooms', 'sqft_living', 'sqft_lot', 'floors', 'waterfront', 'view', 'condition', 'grade', 'sqft_above', 'sqft_basement', 'yr_built', 'yr_renovated', 'zipcode', 'lat', 'long', 'sqft_living15', 'sqft_lot15']
INFO - classes.py - 93 - Requested to remove columns have been set to lowercase.
INFO - classes.py - 102 - All columns exist within the DataFrame, and will be removed.
INFO - classes.py - 109 - Columns ['id', 'date', 'waterfront', 'sqft_above', 'sqft_basement', 'yr_built', 'yr_renovated', 'zipcode', 'lat', 'long', 'sqft_living15', 'sqft_lot15'] have been removed from the dataframe.
INFO - classes.py - 110 - Columns that remain in the frame: ['price', 'bedrooms', 'bathrooms', 'sqft_living', 'sqft_lot', 'floors', 'view', 'condition', 'grade'].
INFO - classes.py - 136 - Label price exists in the dataframe. Attempting to remove...
INFO - classes.py - 140 - Label column has been removed from the dataframe, and will be reinserted at the end.
INFO - classes.py - 141 - Label Column: 0        221900.0
1        538000.0
2        180000.0
3        604000.0
4        510000.0
           ...   
21608    360000.0
21609    400000.0
21610    402101.0
21611    400000.0
21612    325000.0
Name: price, Length: 21613, dtype: float64
INFO - classes.py - 145 - Label column added back to the dataframe.
INFO - classes.py - 146 - Sample of new self.initial_frame:        bedrooms  bathrooms  sqft_living  sqft_lot  floors  view  condition  grade     price
20105         3       3.00         1860      2875     2.0     0          3      8  399950.0
9918          4       2.50         2520      3980     2.0     0          3      8  605000.0
1975          1       0.75          680      9600     1.0     0          3      5  200000.0
3378          4       4.50         3890      5906     2.0     3          3     11  970000.0
10955         3       2.50         1920      3867     2.0     0          3      8  571000.0
14441         3       1.75         2160     22702     1.0     0          4      7  260000.0
11822         3       2.50         2240      7500     2.0     0          3      8  319950.0
4667          4       2.50         2490      8290     2.0     0          3      9  390000.0
17242         3       2.50         1680      1683     2.0     0          3      9  629950.0
21061         3       2.25         1490      4539     2.0     0          3      7  390000.0
INFO - classes.py - 162 - Frame cleaning function called. Making a copy of self.initial_frame before beginning cleaning.
INFO - classes.py - 167 - Whitespaces from column headers have been removed.
INFO - classes.py - 171 - Whitespaces removed from rows/samples in the dataset.
INFO - classes.py - 175 - Special characters, symbols and commas removed from the frame.
INFO - classes.py - 177 - Self.initial_frame has been cleaned. New cleaned frame has been set to self.cleaned_frame
INFO - classes.py - 197 - Frame encoding function has been called. All string data will be converted to numeric (int).
INFO - classes.py - 202 - Self.cleaned_frame has been copied.
INFO - classes.py - 206 - SkLearn OneHotEncoder has been instantiated.
INFO - classes.py - 209 - Iterating through the dataframe to search for columns whose data is of type object.
INFO - classes.py - 248 - Dataframe has finished being encoded. Label/Target column will now be removed and re-added to the end of the frame.
INFO - classes.py - 251 - Label column price has been removed and readded to the end of the dataframe.
INFO - classes.py - 498 - Get features and labels function has been called.
INFO - classes.py - 507 - Columns in DataFrame: ['bedrooms', 'bathrooms', 'sqft_living', 'sqft_lot', 'floors', 'view', 'condition', 'grade', 'price']
INFO - classes.py - 515 - List of Features: ['bedrooms', 'bathrooms', 'sqft_living', 'sqft_lot', 'floors', 'view', 'condition', 'grade']. These columns will be used to create our X variable.
INFO - classes.py - 516 - List of Labels: price. This will be used for our y variable.
INFO - classes.py - 520 - X DataFrame created, and will be used for train_test_split. X Frame Shape: (21613, 8)
INFO - classes.py - 521 - y DataFrame created, and will be used for train_test_split. y Frame Shape: (21613,)
INFO - classes.py - 531 - X and y variables have been split into training and testing data. This first split should not be used to train and tune the machine learing model. It should only be used for training and testing after the model has been trained and tuned.
INFO - classes.py - 532 - First Split Test Size: 0.3
INFO - classes.py - 533 - Size X_train_full: (15129, 8) | Size X_test: (6484, 8)
INFO - classes.py - 534 - Size of y_train_full: (15129,) | Size y_test: (6484,)
INFO - classes.py - 538 - X_train_full and y_train_full have been split again to create training and testing data to train and tune our model. These new variables (X_train, X_val, y_train, y_val) should only be used to find which model works best on our dataset, and then subsequently tuning this model.
INFO - classes.py - 539 - Size X_train: (12103, 8) | Size X_val: (3026, 8)
INFO - classes.py - 540 - Size of y_train: (12103,) | Size y_val: (3026,)
INFO - classes.py - 542 - Testing and Training data have successfully been created. Ready now to get the best model.
INFO - classes.py - 561 - get_best_models function has been called.
INFO - classes.py - 599 - List of models to test: {'linear_regression': LinearRegression(), 'ridge_regression': Ridge(alpha=0.01, max_iter=10000), 'lasso_regression': Lasso(alpha=0.01, max_iter=10000), 'elastic_net': ElasticNet(alpha=0.01, max_iter=10000), 'huber_regression': HuberRegressor(max_iter=10000), 'linear_support_vector': LinearSVR(max_iter=10000), 'gaussian_regressor': GaussianProcessRegressor(), 'gradient_boosting': GradientBoostingRegressor(), 'hist_boosting': HistGradientBoostingRegressor(), 'random_forest': RandomForestRegressor(), 'extra_trees': ExtraTreesRegressor(), 'decision_tree': DecisionTreeRegressor(), 'k_nearest_neighbors': KNeighborsRegressor(), 'support_vector_regressor': SVR(), 'adaboost': AdaBoostRegressor(n_estimators=100), 'bagging_regressor': BaggingRegressor(n_estimators=100), 'stacking_regressor': StackingRegressor(estimators=[('rf', RandomForestRegressor()),
                              ('gb', GradientBoostingRegressor())]), 'neural_network': MLPRegressor(max_iter=10000)}
INFO - classes.py - 606 - Testing each model in the all_models dict now.
INFO - classes.py - 608 - User passed in 1 number of iterations. We will run the model testing 2 amount of times.
INFO - classes.py - 612 - Model Run: 1
INFO - classes.py - 619 - Testing Model: LinearRegression()
INFO - classes.py - 623 - Training Model: LinearRegression()
INFO - classes.py - 648 - Model LinearRegression() is the best model so far for our dataset.
INFO - classes.py - 619 - Testing Model: Ridge(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: Ridge(alpha=0.01, max_iter=10000)
INFO - classes.py - 648 - Model Ridge(alpha=0.01, max_iter=10000) is the best model so far for our dataset.
INFO - classes.py - 619 - Testing Model: Lasso(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: Lasso(alpha=0.01, max_iter=10000)
INFO - classes.py - 619 - Testing Model: ElasticNet(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: ElasticNet(alpha=0.01, max_iter=10000)
INFO - classes.py - 648 - Model ElasticNet(alpha=0.01, max_iter=10000) is the best model so far for our dataset.
INFO - classes.py - 619 - Testing Model: HuberRegressor(max_iter=10000)
INFO - classes.py - 623 - Training Model: HuberRegressor(max_iter=10000)
INFO - classes.py - 619 - Testing Model: LinearSVR(max_iter=10000)
INFO - classes.py - 623 - Training Model: LinearSVR(max_iter=10000)
INFO - classes.py - 619 - Testing Model: GaussianProcessRegressor()
INFO - classes.py - 623 - Training Model: GaussianProcessRegressor()
INFO - classes.py - 619 - Testing Model: GradientBoostingRegressor()
INFO - classes.py - 623 - Training Model: GradientBoostingRegressor()
INFO - classes.py - 648 - Model GradientBoostingRegressor() is the best model so far for our dataset.
INFO - classes.py - 619 - Testing Model: HistGradientBoostingRegressor()
INFO - classes.py - 623 - Training Model: HistGradientBoostingRegressor()
INFO - classes.py - 619 - Testing Model: RandomForestRegressor()
INFO - classes.py - 623 - Training Model: RandomForestRegressor()
INFO - classes.py - 619 - Testing Model: ExtraTreesRegressor()
INFO - classes.py - 623 - Training Model: ExtraTreesRegressor()
INFO - classes.py - 619 - Testing Model: DecisionTreeRegressor()
INFO - classes.py - 623 - Training Model: DecisionTreeRegressor()
INFO - classes.py - 619 - Testing Model: KNeighborsRegressor()
INFO - classes.py - 623 - Training Model: KNeighborsRegressor()
INFO - classes.py - 619 - Testing Model: SVR()
INFO - classes.py - 623 - Training Model: SVR()
INFO - classes.py - 619 - Testing Model: AdaBoostRegressor(n_estimators=100)
INFO - classes.py - 623 - Training Model: AdaBoostRegressor(n_estimators=100)
INFO - classes.py - 619 - Testing Model: BaggingRegressor(n_estimators=100)
INFO - classes.py - 623 - Training Model: BaggingRegressor(n_estimators=100)
INFO - classes.py - 619 - Testing Model: StackingRegressor(estimators=[('rf', RandomForestRegressor()),
                              ('gb', GradientBoostingRegressor())])
INFO - classes.py - 623 - Training Model: StackingRegressor(estimators=[('rf', RandomForestRegressor()),
                              ('gb', GradientBoostingRegressor())])
INFO - classes.py - 619 - Testing Model: MLPRegressor(max_iter=10000)
INFO - classes.py - 623 - Training Model: MLPRegressor(max_iter=10000)
INFO - classes.py - 612 - Model Run: 2
INFO - classes.py - 619 - Testing Model: LinearRegression()
INFO - classes.py - 623 - Training Model: LinearRegression()
INFO - classes.py - 619 - Testing Model: Ridge(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: Ridge(alpha=0.01, max_iter=10000)
INFO - classes.py - 619 - Testing Model: Lasso(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: Lasso(alpha=0.01, max_iter=10000)
INFO - classes.py - 619 - Testing Model: ElasticNet(alpha=0.01, max_iter=10000)
INFO - classes.py - 623 - Training Model: ElasticNet(alpha=0.01, max_iter=10000)
INFO - classes.py - 619 - Testing Model: HuberRegressor(max_iter=10000)
INFO - classes.py - 623 - Training Model: HuberRegressor(max_iter=10000)
INFO - classes.py - 619 - Testing Model: LinearSVR(max_iter=10000)
INFO - classes.py - 623 - Training Model: LinearSVR(max_iter=10000)
INFO - classes.py - 619 - Testing Model: GaussianProcessRegressor()
INFO - classes.py - 623 - Training Model: GaussianProcessRegressor()
INFO - classes.py - 619 - Testing Model: GradientBoostingRegressor()
INFO - classes.py - 623 - Training Model: GradientBoostingRegressor()
INFO - classes.py - 619 - Testing Model: HistGradientBoostingRegressor()
INFO - classes.py - 623 - Training Model: HistGradientBoostingRegressor()
INFO - classes.py - 619 - Testing Model: RandomForestRegressor()
INFO - classes.py - 623 - Training Model: RandomForestRegressor()
INFO - classes.py - 619 - Testing Model: ExtraTreesRegressor()
INFO - classes.py - 623 - Training Model: ExtraTreesRegressor()
INFO - classes.py - 619 - Testing Model: DecisionTreeRegressor()
INFO - classes.py - 623 - Training Model: DecisionTreeRegressor()
INFO - classes.py - 619 - Testing Model: KNeighborsRegressor()
INFO - classes.py - 623 - Training Model: KNeighborsRegressor()
INFO - classes.py - 619 - Testing Model: SVR()
INFO - classes.py - 623 - Training Model: SVR()
INFO - classes.py - 619 - Testing Model: AdaBoostRegressor(n_estimators=100)
INFO - classes.py - 623 - Training Model: AdaBoostRegressor(n_estimators=100)
INFO - classes.py - 619 - Testing Model: BaggingRegressor(n_estimators=100)
INFO - classes.py - 623 - Training Model: BaggingRegressor(n_estimators=100)
INFO - classes.py - 619 - Testing Model: StackingRegressor(estimators=[('rf', RandomForestRegressor()),
                              ('gb', GradientBoostingRegressor())])
INFO - classes.py - 623 - Training Model: StackingRegressor(estimators=[('rf', RandomForestRegressor()),
                              ('gb', GradientBoostingRegressor())])
INFO - classes.py - 619 - Testing Model: MLPRegressor(max_iter=10000)
INFO - classes.py - 623 - Training Model: MLPRegressor(max_iter=10000)
INFO - classes.py - 656 - Each model has been tested. Results have been sorted from best -> worst.
INFO - classes.py - 659 - Top Model: gradient_boosting | R2 Score: 0.6697785232955806
